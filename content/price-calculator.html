<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Safespring Prisrekommendation</title>
  <style>
    /* Grundläggande reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f4f8;
      padding: 20px;
      color: #333;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: #fff;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #00509e;
    }
    .step {
      display: none;
    }
    .step.active {
      display: block;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    input[type="number"] {
      width: 100%;
      padding: 8px;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .btn {
      display: inline-block;
      padding: 10px 20px;
      background: #00509e;
      color: #fff;
      text-align: center;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .btn:hover {
      background: #003f7f;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table, th, td {
      border: 1px solid #ddd;
    }
    th, td {
      padding: 12px;
      text-align: center;
      font-size: 0.9rem;
    }
    th {
      background: #f5f5f5;
    }
    .disclaimer {
      margin-top: 15px;
      font-size: 0.85rem;
      color: #666;
      text-align: center;
    }
    @media (max-width: 600px) {
      input[type="number"] {
        font-size: 0.9rem;
      }
      th, td {
        font-size: 0.8rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Matcha din nuvarande miljö</h1>
    <!-- Steg 1: Användaren anger sin nuvarande miljö -->
    <div id="step1" class="step active">
      <div class="form-group">
        <label for="totalCpu">Total CPU (antal kärnor):</label>
        <input type="number" id="totalCpu" min="0" value="0">
      </div>
      <div class="form-group">
        <label for="totalRam">Total RAM (GB):</label>
        <input type="number" id="totalRam" min="0" value="0">
      </div>
      <div class="form-group">
        <label for="totalDisk">Total lagring (GB):</label>
        <input type="number" id="totalDisk" min="0" value="0">
      </div>
      <button class="btn" id="nextButton">Visa matchande alternativ</button>
    </div>

    <!-- Steg 2: Visa rekommenderade Safespring-alternativ -->
    <div id="step2" class="step">
      <h2>Rekommenderade Alternativ</h2>
      <div id="results"></div>
      <div class="disclaimer">
        Observera: Matchningen är en ungefärlig uppskattning. I praktiken kan en blandning av servrar vara optimal.
      </div>
      <br>
      <button class="btn" id="backButton">Gå tillbaka</button>
    </div>
  </div>

  <script>
    // Exempeldata för Safespring Compute-flavors
    // Flavors med lokal NVMe-disk
    const nvmeFlavours = [
      { id: 'FLAVOR-l2-c2r4-100', name: 'FLAVOR-l2. c2 r4. 100', cpu: 2, ram: 4, disk: 100, price: 480 },
      { id: 'FLAVOR-l2-c2r4-500', name: 'FLAVOR-l2. c2 r4. 500', cpu: 2, ram: 4, disk: 500, price: 880 },
      { id: 'FLAVOR-l2-c2r4-1000', name: 'FLAVOR-l2. c2 r4. 1000', cpu: 2, ram: 4, disk: 1000, price: 1380 },
      { id: 'FLAVOR-l2-c4r8-100', name: 'FLAVOR-l2. c4 r8. 100', cpu: 4, ram: 8, disk: 100, price: 860 },
      { id: 'FLAVOR-l2-c4r8-500', name: 'FLAVOR-l2. c4 r8. 500', cpu: 4, ram: 8, disk: 500, price: 1260 },
      { id: 'FLAVOR-l2-c4r8-1000', name: 'FLAVOR-l2. c4 r8. 1000', cpu: 4, ram: 8, disk: 1000, price: 1760 },
      { id: 'FLAVOR-l2-c8r16-100', name: 'FLAVOR-l2. c8 r16. 100', cpu: 8, ram: 16, disk: 100, price: 1620 },
      { id: 'FLAVOR-l2-c8r16-500', name: 'FLAVOR-l2. c8 r16. 500', cpu: 8, ram: 16, disk: 500, price: 2020 },
      { id: 'FLAVOR-l2-c8r16-1000', name: 'FLAVOR-l2. c8 r16. 1000', cpu: 8, ram: 16, disk: 1000, price: 2520 },
      { id: 'FLAVOR-l2-c16r32-100', name: 'FLAVOR-l2. c16 r32. 100', cpu: 16, ram: 32, disk: 100, price: 3140 },
      { id: 'FLAVOR-l2-c16r32-500', name: 'FLAVOR-l2. c16 r32. 500', cpu: 16, ram: 32, disk: 500, price: 3540 },
      { id: 'FLAVOR-l2-c16r32-1000', name: 'FLAVOR-l2. c16 r32. 1000', cpu: 16, ram: 32, disk: 1000, price: 4040 },
      { id: 'FLAVOR-l2-c16r64-500', name: 'FLAVOR-l2. c16 r64. 500', cpu: 16, ram: 64, disk: 500, price: 5300 },
      { id: 'FLAVOR-l2-c32r64-1000', name: 'FLAVOR-l2. c32 r64.1000', cpu: 32, ram: 64, disk: 1000, price: 7080 }
    ];
    // Flavors utan lokal disk
    const noDiskFlavours = [
      { id: 'FLAVOR-b2-c1r2', name: 'FLAVOR-b2. c1 r2', cpu: 1, ram: 2, disk: 0, price: 190 },
      { id: 'FLAVOR-b2-c1r4', name: 'FLAVOR-b2. c1 r4', cpu: 1, ram: 4, disk: 0, price: 300 },
      { id: 'FLAVOR-b2-c2r4', name: 'FLAVOR-b2. c2 r4', cpu: 2, ram: 4, disk: 0, price: 380 },
      { id: 'FLAVOR-b2-c2r8', name: 'FLAVOR-b2. c2 r8', cpu: 2, ram: 8, disk: 0, price: 600 },
      { id: 'FLAVOR-b2-c4r8', name: 'FLAVOR-b2. c4 r8', cpu: 4, ram: 8, disk: 0, price: 760 },
      { id: 'FLAVOR-b2-c4r16', name: 'FLAVOR-b2. c4 r16', cpu: 4, ram: 16, disk: 0, price: 1200 },
      { id: 'FLAVOR-b2-c8r16', name: 'FLAVOR-b2. c8 r16', cpu: 8, ram: 16, disk: 0, price: 1520 },
      { id: 'FLAVOR-b2-c8r32', name: 'FLAVOR-b2. c8 r32', cpu: 8, ram: 32, disk: 0, price: 2400 },
      { id: 'FLAVOR-b2-c16r32', name: 'FLAVOR-b2. c16 r32', cpu: 16, ram: 32, disk: 0, price: 3040 },
      { id: 'FLAVOR-b2-c16r64', name: 'FLAVOR-b2. c16 r64', cpu: 16, ram: 64, disk: 0, price: 4800 }
    ];
    const allFlavours = nvmeFlavours.concat(noDiskFlavours);

    // Navigering mellan steg
    const step1 = document.getElementById("step1");
    const step2 = document.getElementById("step2");
    const nextButton = document.getElementById("nextButton");
    const backButton = document.getElementById("backButton");

    nextButton.addEventListener("click", () => {
      // Hämta användarens angivna totalspecifikationer
      const totalCpu = parseInt(document.getElementById("totalCpu").value) || 0;
      const totalRam = parseInt(document.getElementById("totalRam").value) || 0;
      const totalDisk = parseInt(document.getElementById("totalDisk").value) || 0;
      // Gå till steg 2 och beräkna matchande alternativ
      showResults(totalCpu, totalRam, totalDisk);
      step1.classList.remove("active");
      step2.classList.add("active");
    });
    backButton.addEventListener("click", () => {
      step2.classList.remove("active");
      step1.classList.add("active");
    });

    // Funktion för att beräkna antal servrar och total kostnad för varje flavor
    function showResults(totalCpu, totalRam, totalDisk) {
      let html = `<table>
        <thead>
          <tr>
            <th>Flavor</th>
            <th>Specifikation</th>
            <th>Antal servrar</th>
            <th>Total kostnad (SEK/30 dagar)</th>
          </tr>
        </thead>
        <tbody>`;
      
      allFlavours.forEach(flavor => {
        // Beräkna antal servrar som krävs för varje resurs
        const countCpu = totalCpu > 0 ? Math.ceil(totalCpu / flavor.cpu) : 0;
        const countRam = totalRam > 0 ? Math.ceil(totalRam / flavor.ram) : 0;
        let countDisk;
        if(flavor.disk > 0) {
          countDisk = totalDisk > 0 ? Math.ceil(totalDisk / flavor.disk) : 0;
        } else {
          // Om flavor inte har lokal disk så kan inte lagringskravet uppfyllas
          countDisk = totalDisk > 0 ? Infinity : 0;
        }
        const serverCount = Math.max(countCpu, countRam, countDisk);
        const totalCost = serverCount * flavor.price;
        
        html += `<tr>
          <td>${flavor.name}</td>
          <td>${flavor.cpu} vCPU, ${flavor.ram}GB RAM, ${flavor.disk > 0 ? flavor.disk + "GB lokal disk" : "Ingen lokal disk"}</td>
          <td>${serverCount === Infinity ? "Ej tillämplig" : serverCount}</td>
          <td>${serverCount === Infinity ? "Ej tillämplig" : totalCost.toLocaleString("sv-SE")}</td>
        </tr>`;
      });
      
      html += `</tbody></table>`;
      document.getElementById("results").innerHTML = html;
    }
  </script>
</body>
</html>